---
layout: 		post
title:		    "iPhone越狱"
date:			2018-07-26
categories:		开发
key: 			10021
---
### 准备

- iPhone6 iOS 11.2.2

### 写在前边

关于自己的手机能不能越狱，是否完美越狱，怎么越狱最方便  
[这里](https://canijailbreak.com/){:target="_blank"} 做了详细说明了  
目前为止 iOS11.4以下的系统都是可以越狱的  

### 越狱

- 做好备份
- 下载[Electra](https://coolstar.org/electra/)  
    下载方式多种多样、以官网为例  
    `Dev account`表示需要一个开发者账号对ipa包进行重新签名来安装  
    `Non Dev Account`就是我们熟知的企业分发版本了  
    但是遇到官网企业分发无法安装、自己又没有开发者账号的情况下 还有第三种选择  

    - 访问[tweakboxapp官网](https://next.tweakboxapp.com/){:target="_blank"}  
    在APPS->CATEGORIES->TweakBox Apps->Electra 11.3.1 下载安装  
    安装完成后在 设置-通用-描述文件与设备管理 中 验证访问  
    - 与官网下载`Electra`不同的是`TweakBox`会使用它自己的多个企业账号签发 `Electra`  
    并在你下载的时候随机分发一个，保证最大程度上的可用  
- 打开`Electra` 点击屏幕中间的`Jailbreak`按钮   
    耐心等待(大约30s) 系统自动重启后 
    如果出现`Cydia`图标 并且打开`Electra`后显示`Already Jailbroken`就表示越狱成功了
- 如果越狱失败 重复之前的步骤 多试几次 总会成功的(我试了大约20次左右)
  
### 遇到的问题

- 如何判断越狱成功  
    iTools软件显示已越狱、手机中安装有Cydia但是打开闪退、iFunBox显示未越狱  
    那么到底越狱成功没有？
    iTools显示是否越狱推测应该是判断Cydia是否安装、iFunBox并不是这个机制  
    最靠谱的判断方法是看Electra显示的是不是`Already Jailbroken`状态  
- 重置手机带来的麻烦  
    - 现象 
        打开Cydia提示`Could not open file /var/lib/dpkg/status`或
        `No such file or directory`黄字或者红字提示  
        或者在Cydia 已安装 tab显示的用户、专业人士、最近都为空    
    - 原因  
        越狱后执行了 设置-通用-还原-抹掉所有内容和设置 这会抹掉Cydia的 `/var/lib`和`/var/log/apt`目录 造成Cydia不能正常工作 自然就报错了  
    - 解决办法  
        恢复缺失目录 [看这里](#解决Cydia目录缺失问题)
    
### 解决Cydia目录缺失问题

- 下载缺失包  
    [mediafire](https://www.mediafire.com/file/bgpyd3c203t3cip/var.lib.apt-mrmad.com.tw.tar){:target="_blank"}  
    [百度网盘](https://pan.baidu.com/s/1_wy8EsUNBAOVPiM5LLWcyw){:target="_blank"}  
- 下载FileZilla  
    [官网](https://filezilla-project.org/download.php?type=client){:target="_blank"}  
- FileZilla连接手机  
    请确保手机和电脑在同一个局域网内 输入手机的IP、用户名root、默认密码alpine、端口22 点击连接  
    将缺失包拷贝到手机指定目录 参考如下图  
    ![](http://77wdec.com1.z0.glb.clouddn.com/923E78F4-394D-417E-B205-AE4D5FF14799.png) 
- 重启Cydia即可  
- 在终端使用ssh命令连接 同时scp到指定目录解压也是同样道理、注意一定要拷对目录    

### 参考连接
- [疯先生](https://mrmad.com.tw/cydia-could-not-open-file-varlibdpkgstatus)  
- [canijailbreak](https://canijailbreak.com/)  